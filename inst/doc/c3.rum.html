<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>3. Random utility model and the multinomial logit model</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>
<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">3. Random utility model and the multinomial logit model</h1>



<div id="random-utility-model" class="section level2">
<h2>Random utility model</h2>
<p>The utility for alternative <span class="math inline">\(l\)</span> is written as: <span class="math inline">\(U_l=V_l+\epsilon_l\)</span> where <span class="math inline">\(V_l\)</span> is a function of some observable covariates and unknown parameters to be estimated, and <span class="math inline">\(\epsilon_l\)</span> is a random deviate which contains all the unobserved determinants of the utility. Alternative <span class="math inline">\(l\)</span> is therefore chosen if <span class="math inline">\(\epsilon_j &lt; (V_l-V_j)+\epsilon_l \;\forall\;j\neq l\)</span> and the probability of choosing this alternative is then:</p>
<p><span class="math display">\[
\mbox{P}(\epsilon_1 &lt; V_l-V_1+\epsilon_l, 
\epsilon_2 &lt; V_l-V_2+\epsilon_l, ..., 
\epsilon_J &lt; V_l-V_J+\epsilon_l).
\]</span></p>
<p>Denoting <span class="math inline">\(F_{-l}\)</span> the cumulative density function of all the <span class="math inline">\(\epsilon\)</span>s except <span class="math inline">\(\epsilon_l\)</span>, this probability is:</p>
<p><span class="math display">\[\begin{equation*}
  (\mbox{P}_l \mid \epsilon_l)=
  F_{-l}(V_l-V_1+\epsilon_l, ..., V_l-V_J+\epsilon_l).
\end{equation*}\]</span></p>
<p>Note that this probability is conditional on the value of <span class="math inline">\(\epsilon_l\)</span>. The unconditional probability (which depends only on <span class="math inline">\(\beta\)</span> and on the value of the observed explanatory variables) is obtained by integrating out the conditional probability using the marginal density of <span class="math inline">\(\epsilon_l\)</span>, denoted <span class="math inline">\(f_l\)</span>:</p>
<p><span class="math display">\[\begin{equation*}
  \mbox{P}_l=\int F_{-l}(V_l-V_1+\epsilon_l, ...,V_l-V_J)+\epsilon_l)f_l(\epsilon_l) d\epsilon_l.
\end{equation*}\]</span></p>
<p>The conditional probability is an integral of dimension <span class="math inline">\(J-1\)</span> and the computation of the unconditional probability adds on more dimension of integration.</p>
</div>
<div id="the-distribution-of-the-error-terms" class="section level2">
<h2>The distribution of the error terms</h2>
<p>The multinomial logit model <span class="citation">(McFadden 1974)</span> is a special case of the model developed in the previous section. It is based on three hypothesis.</p>
<p>The first hypothesis is the independence of the errors. In this case, the univariate distribution of the errors can be used, which leads to the following conditional and unconditional probabilities:</p>
<p><span class="math display">\[\begin{equation*}
  (\mbox{P}_l \mid \epsilon_l)=\prod_{j\neq l}F_j(V_l-V_j+\epsilon_l)
\mbox{ and }
  \mbox{P}_l =\int \prod_{j\neq l}F_j(V_l-V_j+\epsilon_l) \; f_l(\epsilon_l) \;d\epsilon_l,
\end{equation*}\]</span></p>
<p>which means that the conditional probability is the product of <span class="math inline">\(J-1\)</span> univariate cumulative density functions and the evaluation of only a one-dimensional integral is required to compute the unconditional probability.</p>
<p>The second hypothesis is that each <span class="math inline">\(\epsilon\)</span> follows a Gumbel distribution, whose density and probability functions are respectively:</p>
<p><span class="math display">\[\begin{equation}
f(z)=\frac{1}{\theta}e^{-\frac{z-\mu}{\theta}} e^{-e^{-\frac{z-\mu}{\theta}}}
\mbox{ and }
F(z)=\int_{-\infty}^{z} f(t) dt=e^{-e^{-\frac{z-\mu}{\theta}}},
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\mu\)</span> is the location parameter and <span class="math inline">\(\theta\)</span> the scale parameter. The first two moments of the Gumbel distribution are <span class="math inline">\(\mbox{E}(z)=\mu+\theta \gamma\)</span>, where <span class="math inline">\(\gamma\)</span> is the Euler-Mascheroni constant (<span class="math inline">\(\approx 0.577\)</span>) and <span class="math inline">\(\mbox{V}(z)=\frac{\pi^2}{6}\theta^2\)</span>. The mean of <span class="math inline">\(\epsilon_j\)</span> is not identified if <span class="math inline">\(V_j\)</span> contains an intercept. We can then, without loss of generality suppose that <span class="math inline">\(\mu_j=0, \; \forall j\)</span>. Moreover, the overall scale of utility is not identified. Therefore, only <span class="math inline">\(J-1\)</span> scale parameters may be identified, and a natural choice of normalization is to impose that one of the <span class="math inline">\(\theta_j\)</span> is equal to 1.</p>
<p>The last hypothesis is that the errors are identically distributed. As the location parameter is not identified for any error term, this hypothesis is essentially an homoscedasticity hypothesis, which means that the scale parameter of the Gumbel distribution is the same for all the alternatives. As one of them has been previously set to 1, we can therefore suppose that, without loss of generality, <span class="math inline">\(\theta_j = 1, \;\forall j \in 1... J\)</span>. The conditional and unconditional probabilities then further simplify to:</p>
<p><span class="math display">\[\begin{equation*}
  (\mbox{P}_l \mid \epsilon_l)%=\prod_{j\neq l}F(V_l-V_j+\epsilon_l)
  =\prod_{j\neq l}e^{-e^{-(V_l-Vj+\epsilon_l)}}
\mbox{ and }
  \mbox{P}_l =\int_{-\infty}^{+\infty}\prod_{j\neq l}e^{-e^{-(V_l-Vj+t)}}e^{-t}e^{-e^{-t}}dt.
\end{equation*}\]</span></p>
<p>The probabilities have then very simple, closed forms, which correspond to the logit transformation of the deterministic part of the utility.</p>
<p><span class="math display">\[\begin{equation*}
  P_l=\frac{e^{V_l}}{\sum_{j=1}^J e^{V_j}}.
\end{equation*}\]</span></p>
</div>
<div id="iia-property" class="section level2">
<h2>IIA property</h2>
<p>If we consider the probabilities of choice for two alternatives <span class="math inline">\(l\)</span> and <span class="math inline">\(m\)</span>, we have <span class="math inline">\(P_l=\frac{e^{V_l}}{\sum_j e^{V_j}}\)</span> and <span class="math inline">\(P_m=\frac{e^{V_m}}{\sum_j e^{V_j}}\)</span>. The ratio of these two probabilities is:</p>
<p><span class="math display">\[
\frac{P_l}{P_m}=\frac{e^{V_l}}{e^{V_m}}=e^{V_l-V_m}.
\]</span></p>
<p>This probability ratio for the two alternatives depends only on the characteristics of these two alternatives and not on those of other alternatives. This is called the IIA property (for independence of irrelevant alternatives). IIA relies on the hypothesis that the errors are identical and independent. It is not a problem by itself and may even be considered as a useful feature for a well specified model. However, this hypothesis may be in practice violated, especially if some important variables are omitted.</p>
</div>
<div id="interpretation" class="section level2">
<h2>Interpretation</h2>
<p>In a linear model, the coefficients are the marginal effects of the explanatory variables on the explained variable. This is not the case for the multinomial logit model. However, meaningful results can be obtained using relevant transformations of the coefficients.</p>
<div id="marginal-effects" class="section level3">
<h3>Marginal effects</h3>
<p>The marginal effects are the derivatives of the probabilities with respect to the covariates, which can be be choice situation-specific (<span class="math inline">\(z_i\)</span>) or alternative specific (<span class="math inline">\(x_{ij}\)</span>):</p>
<p><span class="math display">\[
  \begin{array}{rcl}
    \displaystyle \frac{\partial P_{il}}{\partial z_{i}}&amp;=&amp;P_{il}\left(\beta_l-\sum_j
    P_{ij}\beta_j\right) \\
    \displaystyle    \frac{\partial P_{il}}{\partial x_{il}}&amp;=&amp;\gamma P_{il}(1-P_{il})\\
    \displaystyle    \frac{\partial P_{il}}{\partial x_{ik}}&amp;=&amp;-\gamma P_{il}P_{ik}.
  \end{array}
\]</span></p>
<ul>
<li><p>For a choice situation specific variable, the sign of the marginal effect is not necessarily the sign of the coefficient. Actually, the sign of the marginal effect is given by <span class="math inline">\(\left(\beta_l-\sum_j P_{ij}\beta_j\right)\)</span>, which is positive if the coefficient for alternative <span class="math inline">\(l\)</span> is greater than a weighted average of the coefficients for all the alternatives, the weights being the probabilities of choosing the alternatives. In this case, the sign of the marginal effect can be established with no ambiguity only for the alternatives with the lowest and the greatest coefficients.</p></li>
<li><p>For an alternative-specific variable, the sign of the coefficient can be directly interpreted. The marginal effect is obtained by multiplying the coefficient by the product of two probabilities which is at most 0.25. The rule of thumb is therefore to divide the coefficient by 4 in order to have an upper bound of the marginal effect.</p></li>
</ul>
<p>Note that the last equation can be rewritten: <span class="math inline">\(\frac{\mbox{d} P_{il} / P_{il}}{\mbox{d}x_{ik}} = -\gamma P_{ik}\)</span>. Therefore, when a characteristic of alternative <span class="math inline">\(k\)</span> changes, the relative change of the probabilities for every alternatives except <span class="math inline">\(k\)</span> are the same, which is a consequence of the IIA property.</p>
</div>
<div id="marginal-rates-of-substitution" class="section level3">
<h3>Marginal rates of substitution</h3>
<p>Coefficients are marginal utilities, which cannot be interpreted. However, ratios of coefficients are marginal rates of substitution. For example, if the observable part of utility is: <span class="math inline">\(V=\beta_o +\beta_1 x_1 +\beta x_2 + \beta x_3\)</span>, join variations of <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> which ensure the same level of utility are such that: <span class="math inline">\(dV=\beta_1 dx_1+\beta_2 dx_2=0\)</span> so that:</p>
<p><span class="math display">\[
- \frac{dx_2}{dx_1}\mid_{dV = 0} = \frac{\beta_1}{\beta_2}.
\]</span></p>
<p>For example, if <span class="math inline">\(x_2\)</span> is transport cost (in $), <span class="math inline">\(x_1\)</span> transport time (in hours), <span class="math inline">\(\beta_1 = 1.5\)</span> and <span class="math inline">\(\beta_2=0.2\)</span>, <span class="math inline">\(\frac{\beta_1}{\beta_2}=30\)</span> is the marginal rate of substitution of time in terms of $ and the value of 30 means that to reduce the travel time of one hour, the individual is willing to pay at most 30$ more. Stated more simply, time value is 30$ per hour.</p>
</div>
<div id="consumers-surplus" class="section level3">
<h3>Consumer’s surplus</h3>
<p>Consumer’s surplus has a very simple expression for multinomial logit models, which was first derived by <span class="citation">Small and Rosen (1981)</span>. The level of utility attained by an individual is <span class="math inline">\(U_j=V_j+\epsilon_j\)</span>, <span class="math inline">\(j\)</span> being the chosen alternative. The expected utility, from the searcher’s point of view is then: <span class="math inline">\(\mbox{E}(\max_j U_j)\)</span>, where the expectation is taken over the values of all the error terms. Its expression is simply, up to an additive unknown constant, the log of the denominator of the logit probabilities, often called the “log-sum”:</p>
<p><span class="math display">\[
\mbox{E}(U)=\ln \sum_{j=1}^Je^{V_j}+C.
\]</span></p>
<p>If the marginal utility of income (<span class="math inline">\(\alpha\)</span>) is known and constant, the expected surplus is simply <span class="math inline">\(\frac{\mbox{E}(U)}{\alpha}\)</span>.</p>
</div>
</div>
<div id="application" class="section level2">
<h2>Application</h2>
<p>Random utility models are fitted using the <code>mlogit</code> function. Basically, only two arguments are mandatory, <code>formula</code> and <code>data</code>, if an <code>dfidx</code> object (and not an ordinary <code>data.frame</code>) is provided.</p>
<div id="modecanada" class="section level3">
<h3>ModeCanada</h3>
<p>We first use the <code>ModeCanada</code> data set, which was already coerced to a <code>dfidx</code> object (called <code>MC</code>) in the previous section. The same model can then be estimated using as <code>data</code> argument this <code>dfidx</code> object:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a><span class="kw">library</span>(<span class="st">&quot;mlogit&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a><span class="kw">data</span>(<span class="st">&quot;ModeCanada&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;mlogit&quot;</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true"></a>MC &lt;-<span class="st"> </span><span class="kw">dfidx</span>(ModeCanada, <span class="dt">subset =</span> noalt <span class="op">==</span><span class="st"> </span><span class="dv">4</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true"></a>ml.MC1 &lt;-<span class="st"> </span><span class="kw">mlogit</span>(choice <span class="op">~</span><span class="st"> </span>cost <span class="op">+</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>ovt <span class="op">|</span><span class="st"> </span>income <span class="op">|</span><span class="st"> </span>ivt, MC)</span></code></pre></div>
<p>or a <code>data.frame</code>. In this latter case, further arguments that will be passed to <code>dfidx</code> should be indicated:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a>ml.MC1b &lt;-<span class="st"> </span><span class="kw">mlogit</span>(choice <span class="op">~</span><span class="st"> </span>cost <span class="op">+</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>ovt <span class="op">|</span><span class="st"> </span>income <span class="op">|</span><span class="st"> </span>ivt, ModeCanada,</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a><span class="dt">subset =</span> noalt <span class="op">==</span><span class="st"> </span><span class="dv">4</span>, <span class="dt">idx =</span> <span class="kw">c</span>(<span class="st">&quot;case&quot;</span>, <span class="st">&quot;alt&quot;</span>))</span></code></pre></div>
<p><code>mlogit</code> provides two further useful arguments:</p>
<ul>
<li><code>reflevel</code> indicates which alternative is the “reference” alternative, i.e., the one for which the coefficients of choice situation specific covariates are set to 0,</li>
<li><code>alt.subset</code> indicates a subset of alternatives on which the estimation has to be performed; in this case, only the lines that correspond to the selected alternatives are used and all the choice situations where not selected alternatives has been chosen are removed.</li>
</ul>
<p>We estimate the model on the subset of three alternatives (we exclude <code>bus</code> whose market share is negligible in our sample) and we set <code>car</code> as the reference alternative. Moreover, we use a total transport time variable computed as the sum of the in vehicle and the out of vehicle time variables.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a>MC<span class="op">$</span>time &lt;-<span class="st"> </span><span class="kw">with</span>(MC, ivt <span class="op">+</span><span class="st"> </span>ovt)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a>ml.MC1 &lt;-<span class="st"> </span><span class="kw">mlogit</span>(choice <span class="op">~</span><span class="st"> </span>cost <span class="op">+</span><span class="st"> </span>freq <span class="op">|</span><span class="st"> </span>income <span class="op">|</span><span class="st"> </span>time, MC, </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true"></a><span class="dt">alt.subset =</span> <span class="kw">c</span>(<span class="st">&quot;car&quot;</span>, <span class="st">&quot;train&quot;</span>, <span class="st">&quot;air&quot;</span>), <span class="dt">reflevel =</span> <span class="st">&quot;car&quot;</span>)</span></code></pre></div>
<p>The main results of the model are computed and displayed using the <code>summary</code> method:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a><span class="kw">summary</span>(ml.MC1)</span></code></pre></div>
<pre><code>## 
## Call:
## mlogit(formula = choice ~ cost + freq | income | time, data = MC, 
##     alt.subset = c(&quot;car&quot;, &quot;train&quot;, &quot;air&quot;), reflevel = &quot;car&quot;, 
##     method = &quot;nr&quot;)
## 
## Frequencies of alternatives:choice
##     car   train     air 
## 0.45757 0.16721 0.37523 
## 
## nr method
## 6 iterations, 0h:0m:0s 
## g&#39;(-H)^-1g = 6.94E-06 
## successive function values within tolerance limits 
## 
## Coefficients :
##                      Estimate  Std. Error  z-value  Pr(&gt;|z|)    
## (Intercept):train -0.97034440  0.26513065  -3.6599 0.0002523 ***
## (Intercept):air   -1.89856552  0.68414300  -2.7751 0.0055185 ** 
## cost              -0.02849715  0.00655909  -4.3447 1.395e-05 ***
## freq               0.07402902  0.00473270  15.6420 &lt; 2.2e-16 ***
## income:train      -0.00646892  0.00310366  -2.0843 0.0371342 *  
## income:air         0.02824632  0.00365435   7.7295 1.088e-14 ***
## time:car          -0.01402405  0.00138047 -10.1589 &lt; 2.2e-16 ***
## time:train        -0.01096877  0.00081834 -13.4036 &lt; 2.2e-16 ***
## time:air          -0.01755120  0.00399181  -4.3968 1.099e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Log-Likelihood: -1951.3
## McFadden R^2:  0.31221 
## Likelihood ratio test : chisq = 1771.6 (p.value = &lt; 2.22e-16)</code></pre>
<p>The frequencies of the different alternatives in the sample are first indicated. Next, some information about the optimization are displayed: the Newton-Ralphson method (with analytic gradient and hessian) is used, as it is the most efficient method for this simple model for which the log-likelihood function is concave. Note that very few iterations and computing time are required to estimate this model. Then the usual table of coefficients is displayed followed by some goodness of fit measures: the value of the log-likelihood function, which is compared to the value when only intercepts are introduced, which leads to the computation of the McFadden <span class="math inline">\(R^2\)</span> and to the likelihood ratio test.</p>
<p>The <code>fitted</code> method can be used either to obtain the probability of actual choices (<code>type = &quot;outcome&quot;</code>) or the probabilities for all the alternatives (<code>type = &quot;probabilities&quot;</code>).</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="kw">head</span>(<span class="kw">fitted</span>(ml.MC1, <span class="dt">type =</span> <span class="st">&quot;outcome&quot;</span>))</span></code></pre></div>
<pre><code>##       109       110       111       112       113       114 
## 0.1909475 0.3399941 0.1470527 0.3399941 0.3399941 0.2440011</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a><span class="kw">head</span>(<span class="kw">fitted</span>(ml.MC1, <span class="dt">type =</span> <span class="st">&quot;probabilities&quot;</span>), <span class="dv">4</span>)</span></code></pre></div>
<pre><code>##           car     train       air
## 109 0.4206404 0.3884120 0.1909475
## 110 0.3696476 0.2903582 0.3399941
## 111 0.4296769 0.4232704 0.1470527
## 112 0.3696476 0.2903582 0.3399941</code></pre>
<p>Note that the log-likelihood is the sum of the log of the fitted outcome probabilities and that, as the model contains intercepts, the average fitted probabilities for every alternative equals the market shares of the alternatives in the sample.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true"></a><span class="kw">sum</span>(<span class="kw">log</span>(<span class="kw">fitted</span>(ml.MC1, <span class="dt">type =</span> <span class="st">&quot;outcome&quot;</span>)))</span></code></pre></div>
<pre><code>## [1] -1951.344</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true"></a><span class="kw">logLik</span>(ml.MC1)</span></code></pre></div>
<pre><code>## &#39;log Lik.&#39; -1951.344 (df=9)</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true"></a><span class="kw">apply</span>(<span class="kw">fitted</span>(ml.MC1, <span class="dt">type =</span> <span class="st">&quot;probabilities&quot;</span>), <span class="dv">2</span>, mean)</span></code></pre></div>
<pre><code>##       car     train       air 
## 0.4575659 0.1672084 0.3752257</code></pre>
<p>Predictions can be made using the <code>predict</code> method. If no data is provided, predictions are made for the sample mean values of the covariates.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true"></a><span class="kw">predict</span>(ml.MC1)</span></code></pre></div>
<pre><code>##       car     train       air 
## 0.5066362 0.2116876 0.2816761</code></pre>
<p>Assume, for example, that we wish to predict the effect of a reduction of train transport time of 20%. We first create a new <code>data.frame</code> simply by multiplying train transport time by 0.8 and then using the <code>predict</code> method with this new <code>data.frame</code>.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true"></a>NMC &lt;-<span class="st"> </span>MC</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true"></a><span class="co"># YC2020/05/03 should replace everywhere index() by idx()</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true"></a>NMC[<span class="kw">idx</span>(NMC)<span class="op">$</span>alt <span class="op">==</span><span class="st"> &quot;train&quot;</span>, <span class="st">&quot;time&quot;</span>] &lt;-<span class="st"> </span><span class="fl">0.8</span> <span class="op">*</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true"></a>NMC[<span class="kw">idx</span>(NMC)<span class="op">$</span>alt <span class="op">==</span><span class="st"> &quot;train&quot;</span>, <span class="st">&quot;time&quot;</span>]</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true"></a>Oprob &lt;-<span class="st"> </span><span class="kw">fitted</span>(ml.MC1, <span class="dt">type =</span> <span class="st">&quot;probabilities&quot;</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true"></a>Nprob &lt;-<span class="st"> </span><span class="kw">predict</span>(ml.MC1, <span class="dt">newdata =</span> NMC)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true"></a><span class="kw">rbind</span>(<span class="dt">old =</span> <span class="kw">apply</span>(Oprob, <span class="dv">2</span>, mean), <span class="dt">new =</span> <span class="kw">apply</span>(Nprob, <span class="dv">2</span>, mean))</span></code></pre></div>
<pre><code>##           car     train       air
## old 0.4575659 0.1672084 0.3752257
## new 0.4044736 0.2635801 0.3319462</code></pre>
<p>If, for the first individuals in the sample, we compute the ratio of the probabilities of the air and the car mode, we obtain:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true"></a><span class="kw">head</span>(Nprob[, <span class="st">&quot;air&quot;</span>] <span class="op">/</span><span class="st"> </span>Nprob[, <span class="st">&quot;car&quot;</span>])</span></code></pre></div>
<pre><code>##       109       110       111       112       113       114 
## 0.4539448 0.9197791 0.3422401 0.9197791 0.9197791 0.6021092</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true"></a><span class="kw">head</span>(Oprob[, <span class="st">&quot;air&quot;</span>] <span class="op">/</span><span class="st"> </span>Oprob[, <span class="st">&quot;car&quot;</span>])</span></code></pre></div>
<pre><code>##       109       110       111       112       113       114 
## 0.4539448 0.9197791 0.3422401 0.9197791 0.9197791 0.6021092</code></pre>
<p>which is an illustration of the IIA property. If train time changes, it changes the probabilities of choosing air and car, but not their ratio.</p>
<p>We next compute the surplus for individuals of the sample induced by train time reduction. This requires the computation of the log-sum term (also called inclusive value or inclusive utility) for every choice situation, which is:</p>
<p><span class="math display">\[
\mbox{iv}_i = \ln \sum_{j = 1} ^ J e^{\beta^\top x_{ij}}.
\]</span></p>
<p>For this purpose, we use the <code>logsum</code> function, which works on a vector of <code>coefficients</code> and a <code>model.matrix</code>. The basic use of <code>logsum</code> consists on providing as unique argument (called <code>coef</code>) a <code>mlogit</code> object. In this case, the <code>model.matrix</code> and the <code>coef</code> are extracted from the same model.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true"></a>ivbefore &lt;-<span class="st"> </span><span class="kw">logsum</span>(ml.MC1)</span></code></pre></div>
<p>To compute the log-sum after train time reduction, we must provide a <code>model.matrix</code> which is not the one corresponding to the fitted model. This can be done using the <code>X</code> argument which is a matrix or an object from which a <code>model.matrix</code> can be extracted. This can also be done by filling the <code>data</code> argument (a <code>data.frame</code> or an object from which a <code>data.frame</code> can be extracted using a <code>model.frame</code> method), and eventually the <code>formula</code> argument (a <code>formula</code> or an object for which the <code>formula</code> method can be applied). If no formula is provided but if <code>data</code> is a <code>dfidx</code> object, the formula is extracted from it.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true"></a>ivafter &lt;-<span class="st"> </span><span class="kw">logsum</span>(ml.MC1, <span class="dt">data =</span> NMC)</span></code></pre></div>
<p>Surplus variation is then computed as the difference of the log-sums divided by the opposite of the cost coefficient which can be interpreted as the marginal utility of income:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true"></a>surplus &lt;-<span class="st"> </span><span class="op">-</span><span class="st"> </span>(ivafter <span class="op">-</span><span class="st"> </span>ivbefore) <span class="op">/</span><span class="st"> </span><span class="kw">coef</span>(ml.MC1)[<span class="st">&quot;cost&quot;</span>]</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true"></a><span class="kw">summary</span>(surplus)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  0.5852  2.8439  3.8998  4.6971  5.8437 31.3912</code></pre>
<p>Consumer’s surplus variation range from 0.6 to 31 Canadian $, with a median value of about 4$.</p>
<p>Marginal effects are computed using the <code>effects</code> method. By default, they are computed at the sample mean, but a <code>data</code> argument can be provided. The variation of the probability and of the covariate can be either absolute or relative. This is indicated with the <code>type</code> argument which is a combination of two <code>a</code> (as absolute) and <code>r</code> (as relative) characters. For example, <code>type = &quot;ar&quot;</code> means that what is measured is an absolute variation of the probability for a relative variation of the covariate.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true"></a><span class="kw">effects</span>(ml.MC1, <span class="dt">covariate =</span> <span class="st">&quot;income&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;ar&quot;</span>)</span></code></pre></div>
<pre><code>##        car      train        air 
## -0.1822177 -0.1509079  0.3331256</code></pre>
<p>The results indicate that, for a 100% increase of income, the probability of choosing <code>air</code> increases by 33 points of percentage, as the probabilities of choosing <code>car</code> and <code>train</code> decrease by 18 and 15 points of percentage.</p>
<p>For an alternative specific covariate, a matrix of marginal effects is displayed.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true"></a><span class="kw">effects</span>(ml.MC1, <span class="dt">covariate =</span> <span class="st">&quot;cost&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;rr&quot;</span>)</span></code></pre></div>
<pre><code>##              car      train        air
## car   -0.9131273  0.9376923  0.9376923
## train  0.3358005 -1.2505014  0.3358005
## air    1.2316679  1.2316679 -3.1409703</code></pre>
<p>The cell in the <span class="math inline">\(l^{\mbox{th}}\)</span> row and the <span class="math inline">\(c^{\mbox{th}}\)</span> column indicates the change of the probability of choosing alternative <span class="math inline">\(c\)</span> when the cost of alternative <span class="math inline">\(l\)</span> changes. As <code>type = &quot;rr&quot;</code>, elasticities are computed. For example, a 10% change of train cost increases the probabilities of choosing car and air by 3.36%. Note that the relative changes of the probabilities of choosing one of these two modes are equal, which is a consequence of the IIA property.</p>
<p>Finally, in order to compute travel time valuation, we divide the coefficients of travel times (in minutes) by the coefficient of monetary cost (in $).</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true"></a><span class="kw">coef</span>(ml.MC1)[<span class="kw">grep</span>(<span class="st">&quot;time&quot;</span>, <span class="kw">names</span>(<span class="kw">coef</span>(ml.MC1)))] <span class="op">/</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true"></a><span class="st">    </span><span class="kw">coef</span>(ml.MC1)[<span class="st">&quot;cost&quot;</span>] <span class="op">*</span><span class="st"> </span><span class="dv">60</span> </span></code></pre></div>
<pre><code>##   time:car time:train   time:air 
##   29.52728   23.09447   36.95360</code></pre>
<p>The value of travel time ranges from 23 for train to 37 Canadian $ per hour for plane.</p>
</div>
<div id="nox" class="section level3">
<h3>NOx</h3>
<p>The second example is a data set used by <span class="citation">Fowlie (2010)</span>, called <code>NOx</code>. She analyzed the effect of an emissions trading program (the NOx budget program which seeks to reduce the emission of nitrogen oxides) on the behavior of producers. More precisely, coal electricity plant managers may adopt one out of fifteen different technologies in order to comply to the emissions defined by the program. Some of them require high investment (the capital cost is <code>kcost</code>) and are very efficient to reduce emissions, some other require much less investment but are less efficient and the operating cost (denoted <code>vcost</code>) is then higher, especially because pollution permits must be purchased to offset emissions exceeding their allocation.</p>
<p>The focus of the paper is on the effects of the regulatory environment on manager’s behavior. Some firms are deregulated, whereas other are either regulated or public. Rate of returns is applied for regulated firms, which means that they perceive a “fair” rate of return on their investment. Public firms also enjoy significant cost of capital advantages. Therefore, the main hypothesis of the paper is that public and regulated firms will adopt much more capitalistic intensive technologies than deregulated and public ones, which means that the coefficient of capital cost should take a higher negative value for deregulated firms. Capital cost is interacted with the age of the plant (measured as a deviation from the sample mean age), as firms should weight capital costs more heavily for older plants, as they have less time to recover these costs.</p>
<p>Multinomial logit models are estimated for the three subsamples defined by the regulatory environment. The 15 technologies are not available for every plants, the sample is therefore restricted to available technologies, using the <code>available</code> covariate. Three technology dummies are introduced: <code>post</code> for post-combustion polution control technology, <code>cm</code> for combustion modification technology and <code>lnb</code> for low NOx burners technology.</p>
<p>A last model is estimated for the whole sample, but the parameters are allowed to be proportional to each other. The scedasticity function is described in the fourth part of the formula, it contains here only one covariate, <code>env</code>. Note also that for the last model, the author introduced a specific capital cost coefficient for deregulated firms.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true"></a><span class="kw">data</span>(<span class="st">&quot;NOx&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;mlogit&quot;</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true"></a>NOx<span class="op">$</span>kdereg &lt;-<span class="st"> </span><span class="kw">with</span>(NOx, kcost <span class="op">*</span><span class="st"> </span>(env <span class="op">==</span><span class="st"> &quot;deregulated&quot;</span>))</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true"></a>NOxml &lt;-<span class="st"> </span><span class="kw">dfidx</span>(NOx, <span class="dt">idx =</span> <span class="kw">list</span>(<span class="kw">c</span>(<span class="st">&quot;chid&quot;</span>, <span class="st">&quot;id&quot;</span>), <span class="st">&quot;alt&quot;</span>))</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true"></a>ml.pub &lt;-<span class="st"> </span><span class="kw">mlogit</span>(choice <span class="op">~</span><span class="st"> </span>post <span class="op">+</span><span class="st"> </span>cm <span class="op">+</span><span class="st"> </span>lnb <span class="op">+</span><span class="st"> </span>vcost <span class="op">+</span><span class="st"> </span>kcost <span class="op">+</span><span class="st"> </span>kcost<span class="op">:</span>age <span class="op">|</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true"></a><span class="op">-</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">subset =</span> available <span class="op">&amp;</span><span class="st"> </span>env <span class="op">==</span><span class="st"> &quot;public&quot;</span>, <span class="dt">data =</span> NOxml)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true"></a>ml.reg &lt;-<span class="st"> </span><span class="kw">update</span>(ml.pub, <span class="dt">subset =</span> available <span class="op">&amp;</span><span class="st"> </span>env <span class="op">==</span><span class="st"> &quot;regulated&quot;</span>)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true"></a>ml.dereg &lt;-<span class="st"> </span><span class="kw">update</span>(ml.pub, <span class="dt">subset =</span> available <span class="op">&amp;</span><span class="st"> </span>env <span class="op">==</span><span class="st"> &quot;deregulated&quot;</span>)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true"></a>ml.pool &lt;-<span class="st"> </span>ml.dereg</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true"></a><span class="co"># YC gestion de la quatrième partie</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true"></a>ml.pool &lt;-<span class="st"> </span><span class="kw">mlogit</span>(choice <span class="op">~</span><span class="st"> </span>post <span class="op">+</span><span class="st"> </span>cm <span class="op">+</span><span class="st"> </span>lnb <span class="op">+</span><span class="st"> </span>vcost <span class="op">+</span><span class="st"> </span>kcost <span class="op">+</span><span class="st"> </span>kcost<span class="op">:</span>age <span class="op">+</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true"></a>kdereg <span class="op">|</span><span class="st"> </span><span class="op">-</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span><span class="dv">0</span> <span class="op">|</span><span class="st"> </span>env, <span class="dt">subset =</span> available <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data =</span> NOxml,</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true"></a><span class="dt">method =</span> <span class="st">&quot;bhhh&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true"></a><span class="kw">library</span>(<span class="st">&quot;texreg&quot;</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true"></a><span class="kw">htmlreg</span>(<span class="kw">list</span>(<span class="dt">Public =</span> ml.pub, <span class="dt">Deregulated =</span> ml.dereg, <span class="dt">Regulated =</span> ml.reg,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true"></a>             <span class="dt">Pooled =</span> ml.pool), <span class="dt">caption =</span> <span class="st">&quot;Environmental compliance choices.&quot;</span>,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true"></a>        <span class="dt">omit.coef =</span> <span class="st">&quot;(post)|(cm)|(lnb)&quot;</span>, <span class="dt">float.pos =</span> <span class="st">&quot;hbt&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;tab:nox&quot;</span>)</span></code></pre></div>
<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;caption-side: bottom;color: #000000;border-top: 2px solid #000000;">
<caption>
Environmental compliance choices.
</caption>
<thead>
<tr>
<th style="padding-left: 5px;padding-right: 5px;">
 
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Public
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Deregulated
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Regulated
</th>
<th style="padding-left: 5px;padding-right: 5px;">
Pooled
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
vcost
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-1.56<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.19<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.28<sup>***</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.31<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.36)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.06)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.06)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.04)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
kcost
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.04
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.06<sup>**</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.01
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.01
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.11)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.02)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.03)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.02)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
kcost:age
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.08
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.04<sup>**</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.02<sup>*</sup>
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.02<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.04)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.01)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.01)
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.01)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
kdereg
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.07<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.01)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
sig.envderegulated
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
0.32<sup>**</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.12)
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
sig.envpublic
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-0.33<sup>***</sup>
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
 
</td>
<td style="padding-left: 5px;padding-right: 5px;">
(0.08)
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
AIC
</td>
<td style="padding-left: 5px;padding-right: 5px;">
168.92
</td>
<td style="padding-left: 5px;padding-right: 5px;">
690.15
</td>
<td style="padding-left: 5px;padding-right: 5px;">
731.48
</td>
<td style="padding-left: 5px;padding-right: 5px;">
1634.22
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Log Likelihood
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-78.46
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-339.07
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-359.74
</td>
<td style="padding-left: 5px;padding-right: 5px;">
-808.11
</td>
</tr>
<tr>
<td style="padding-left: 5px;padding-right: 5px;">
Num. obs.
</td>
<td style="padding-left: 5px;padding-right: 5px;">
113
</td>
<td style="padding-left: 5px;padding-right: 5px;">
227
</td>
<td style="padding-left: 5px;padding-right: 5px;">
292
</td>
<td style="padding-left: 5px;padding-right: 5px;">
632
</td>
</tr>
<tr style="border-bottom: 2px solid #000000;">
<td style="padding-left: 5px;padding-right: 5px;">
K
</td>
<td style="padding-left: 5px;padding-right: 5px;">
15
</td>
<td style="padding-left: 5px;padding-right: 5px;">
15
</td>
<td style="padding-left: 5px;padding-right: 5px;">
15
</td>
<td style="padding-left: 5px;padding-right: 5px;">
15
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="5">
<sup>***</sup>p &lt; 0.001; <sup>**</sup>p &lt; 0.01; <sup>*</sup>p &lt; 0.05
</td>
</tr>
</tfoot>
</table>
<p>Results are presented in the preceeding table, using the <code>texreg</code> package <span class="citation">(Leifeld 2013)</span>. Coefficients are very different on the sub-samples defined by the regulatory environment. Note in particular that the capital cost coefficient is positive and insignificant for public and regulated firms, as it is significantly negative for deregulated firms. Errors seems to have significant larger variance for deregulated firms and lower ones for public firms compared to regulated firms. The hypothesis that the coefficients (except the <code>kcost</code> one) are identical up to a multiplicative scalar can be performed using a likelihood ratio test:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true"></a>stat &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(<span class="kw">logLik</span>(ml.dereg) <span class="op">+</span><span class="st"> </span><span class="kw">logLik</span>(ml.reg) <span class="op">+</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true"></a><span class="st">             </span><span class="kw">logLik</span>(ml.pub) <span class="op">-</span><span class="st"> </span><span class="kw">logLik</span>(ml.pool))</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true"></a>stat</span></code></pre></div>
<pre><code>## &#39;log Lik.&#39; 61.6718 (df=6)</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true"></a><span class="kw">pchisq</span>(stat, <span class="dt">df =</span> <span class="dv">9</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## &#39;log Lik.&#39; 6.377283e-10 (df=6)</code></pre>
<p>The hypothesis is strongly rejected.</p>
</div>
</div>
<div id="bibliography" class="section level2 unnumbered">
<h2 class="unnumbered">Bibliography</h2>
<div id="refs" class="references hanging-indent">
<div id="ref-FOWL:10">
<p>Fowlie, Meredith. 2010. “Emissions Trading, Electricity Restructuring, and Investment in Pollution Abatement.” <em>American Economic Review</em> 100 (3): 837–69. <a href="https://doi.org/10.1257/aer.100.3.837">https://doi.org/10.1257/aer.100.3.837</a>.</p>
</div>
<div id="ref-LEIF:13">
<p>Leifeld, Philip. 2013. “texreg: Conversion of Statistical Model Output in R to LaTeX and HTML Tables.” <em>Journal of Statistical Software</em> 55 (8): 1–24. <a href="https://doi.org/10.18637/jss.v055.i08">https://doi.org/10.18637/jss.v055.i08</a>.</p>
</div>
<div id="ref-MCFAD:74">
<p>McFadden, D. 1974. “The Measurement of Urban Travel Demand.” <em>Journal of Public Economics</em> 3: 303–28.</p>
</div>
<div id="ref-SMAL:ROSE:81">
<p>Small, K. A., and H. S. Rosen. 1981. “Applied Welfare Economics with Discrete Choice Models.” <em>Econometrica</em> 49: 105–30.</p>
</div>
<div id="ref-MAXLIK:10">
<p>Toomet, Ott, and Arne Henningsen. 2010. <em>MaxLik: Maximum Likelihood Estimation</em>. <a href="https://CRAN.R-project.org/package=maxLik">https://CRAN.R-project.org/package=maxLik</a>.</p>
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Note the use of the <code>method</code> argument, set to <code>bhhh</code>. <code>mlogit</code> use its own optimisation functions, but borrows its syntax from package <code>maxLik</code> <span class="citation">(Toomet and Henningsen 2010)</span>. The default method is <code>bfgs</code>, except for the basic model, for which it is <code>nr</code>. As the default algorithm failed to converged, we use here <code>bhhh</code>.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
